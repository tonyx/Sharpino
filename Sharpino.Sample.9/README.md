# Course Management System Example (Sharpino.Sample.9)

## Overview

(note: this readme is generated by A.I. and may need further review).

This example demonstrates a comprehensive Course Management System built with Sharpino, showcasing event sourcing patterns and domain modeling in F#. The system manages courses, students, teachers, and financial transactions while enforcing complex business rules.

## Key Features

1. **Course Management**
   - Create and delete courses
   - Set course capacity
   - Track course enrollment

2. **Student Management**
   - Student registration
   - Course enrollment with capacity checks
   - Balance tracking

3. **Teacher Management**
   - Teacher assignment to courses
   - Teaching preferences and constraints
   - Workload management

4. **Financial Transactions**
   - Track student balances
   - Process course fees and refunds
   - Handle course cancellation fees

## Domain Model

The system consists of several interconnected aggregates:

- **Course**: Represents an educational course with capacity, enrolled students, and assigned teachers
- **Student**: Tracks student information, enrolled courses, and balance
- **Teacher**: Manages teacher information, assigned courses, and teaching preferences
- **Balance**: Handles financial transactions and fee management

## Business Rules

1. **Enrollment Rules**
   - Students cannot enroll in a course that's at capacity
   - Teachers may have constraints on which courses they can teach

2. **Teacher Assignment**
   - Teachers can be assigned to multiple courses
   - Some teachers may refuse to teach certain student combinations
   - Workload limits for teachers

3. **Financial Rules**
   - Course fees are deducted from student balances upon enrollment
   - Cancellation fees may apply when dropping courses
   - Refunds are processed according to policy

## Technical Highlights

1. **Event Sourcing**
   - Full audit trail of all changes
   - Time-travel debugging capabilities
   - Event replay for state reconstruction

2. **Aggregate Design**
   - Clear aggregate boundaries
   - Consistent state transitions
   - Optimistic concurrency control

3. **Testing**
   - Comprehensive test suite
   - In-memory and PostgreSQL storage backends
   - Test scenarios for all major features

## Getting Started

1. **Prerequisites**
   - .NET 9.0 SDK
   - PostgreSQL (for persistent storage)
   - F# development environment

2. **Setup**
   - Configure database connection in `.env` file
   - Run database migrations
   - Build and run the test suite

3. **Running Tests**
   ```bash
   dotnet test
   ```

## Example Usage

```fsharp
// Create a new course
let course = Course.MkCourse("Advanced F#", 25)
let courseManager = CourseManager(eventStore, courseViewer, studentViewer, balanceViewer, teacherViewer, initialBalance)
let addCourse = courseManager.AddCourse course

// Register a student
let student = Student.MkStudent("John Doe")
let addStudent = courseManager.AddStudent student

// Enroll student in course
let enroll = courseManager.EnrollStudent(course.Id, student.Id)
```

## Dependencies

- Sharpino.Lib
- FSharp.Core
- Expecto (for testing)
- DotNetEnv (for configuration)

## License

This example is part of the Sharpino library and is licensed under the MIT License.